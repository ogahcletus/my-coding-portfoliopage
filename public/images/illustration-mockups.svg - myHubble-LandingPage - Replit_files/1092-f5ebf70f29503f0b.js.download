"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1092],{92010:function(e,n,i){i.d(n,{Z:function(){return I}});var t=i(10253),r=i(35944),a=i(67294),o=i(86292),l=i(63377),s=i(98099),d=i(91131),c=i(20934),u=i(60731),m=i(75026),p=i(67629);var f=function(e){var n,i=e.unreadThreadCount,t=void 0===i?0:i,a=e.isOpen,o=e.onClick,l=t>0;return(0,r.BX)(u.G7,{css:[u.l0.position.relative],children:[l?(0,r.tZ)("div",{css:[u.l0.width(8),u.l0.height(8),u.l0.backgroundColor.redStronger,u.l0.position.absolute,a?u.l0.top(1):u.l0.top(-2),a?u.l0.right(1):u.l0.right(-2),u.l0.transition.snappy,u.l0.borderRadius("full")]}):null,(0,r.tZ)(u.hU,{size:28,alt:(n=a,n?"Hide inbox":"View inbox"),onClick:o,css:[u.l0.width(36),u.l0.height(36),u.l0.transition.snappy,u.l0.cursor.pointer,a?u.l0.borderRadius("full"):u.l0.borderRadius(8),{borderWidth:u.TV.borderWidthDefault,borderStyle:"solid",borderColor:a?u.TV.accentPrimaryDefault:u.TV.outlineStronger,backgroundColor:a?u.TV.accentPrimaryDimmer:u.TV.backgroundHighest},{":hover":{borderColor:u.TV.accentPrimaryDefault,background:u.TV.accentPrimaryDimmest+" !important"}}],children:a?(0,r.tZ)(p.Z,{size:24}):(0,r.tZ)(m.Z,{size:24})})]})},v=i(54810),h=i(60536),b=i.n(h),g=i(6357),Z=i(81255),x=i(29815),y=i(90317),w=i(81979),k=i(9583),j=i(32951);function _(e){var n,i,o,l,s=e.onClick,d=(0,y.r92)(),c=(0,v.Z)("flag-threads-popup-notifications"),u=a.useContext(w.Z).generalThread,m=function(e){var n=(0,t.Z)(a.useState([]),2),i=n[0],r=n[1],o=(0,t.Z)(a.useState(null),2),l=o[0],s=o[1],d=a.useRef(i);d.current=i;var c=a.useRef(null);return a.useEffect((function(){if(null===c.current){var e=i[0];e&&(s(e),c.current=setTimeout((function(){r(d.current.slice(1)),0===d.current.length&&s(null),c.current=null}),2500))}}),[i]),(0,j.Z)((function(){e[e.length-1]&&r((0,x.Z)(i).concat([e[e.length-1]]))}),[e.length]),l}((null===u||void 0===u?void 0:u.messages)||[]),p=a.useMemo((function(){if("TextMessageContentType"!==(null===m||void 0===m?void 0:m.content.__typename))return null;var e=null===m||void 0===m?void 0:m.content.text;return e?(0,k.kW)(e,{}):null}),[m]),f=(0,y.WWj)({variables:{username:(null===m||void 0===m||null===(n=m.user)||void 0===n?void 0:n.username)||""}}).data,h=(null===f||void 0===f||null===(i=f.user)||void 0===i?void 0:i.image)||null;return c&&m&&m.user&&m.user.id!==(null===(o=d.data)||void 0===o||null===(l=o.currentUser)||void 0===l?void 0:l.id)?(0,r.BX)("div",{onClick:function(e){e.stopPropagation(),s(e)},className:"jsx-4ee14b2dec205719 message-notification",children:[h?(0,r.tZ)("img",{src:h,className:"jsx-4ee14b2dec205719 chat-message-picture"}):(0,r.tZ)("div",{className:"jsx-4ee14b2dec205719 chat-message-picture"}),(0,r.BX)("div",{className:"jsx-4ee14b2dec205719 message",children:[(0,r.tZ)("span",{className:"jsx-4ee14b2dec205719 dimmed-text",children:m.user.username}),":"," ",(0,r.tZ)("span",{className:"jsx-4ee14b2dec205719 bold-text",children:p&&(0,r.tZ)(k.YI,{message:p})})]}),(0,r.tZ)(b(),{id:"4ee14b2dec205719",children:".message-notification.jsx-4ee14b2dec205719{background:var(--background-default);border:1px solid var(--accent-purple-default);position:absolute;right:60px;bottom:0;color:var(--foreground-default);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;padding:3px 15px;cursor:auto;max-width:250px;width:auto;height:36px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;opacity:1;cursor:pointer;font-size:14px}.chat-message-picture.jsx-4ee14b2dec205719{min-width:24px;margin-right:10px;width:24px;-webkit-border-radius:15px;-moz-border-radius:15px;border-radius:15px;border:1px solid transparent}.bold-text.jsx-4ee14b2dec205719{color:var(--foreground-default)}.dimmed-text.jsx-4ee14b2dec205719{color:var(--foreground-dimmest)}.message.jsx-4ee14b2dec205719{-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}"})]}):null}var C=function(e){var n=e.unreadThreadCount,i=e.onClick;return(0,r.BX)("div",{onClick:i,css:{backgroundColor:Z.TV.blurpleDefault},className:b().dynamic([["6310b31df33ae425",[Z.TV.borderRadius8,Z.TV.borderRadius8]]])+" floating-icon-wrapper",children:[(0,r.tZ)(_,{onClick:i}),(0,r.tZ)("div",{className:b().dynamic([["6310b31df33ae425",[Z.TV.borderRadius8,Z.TV.borderRadius8]]])+" chat-icon-wrapper",children:(0,r.tZ)(g.Z,{})}),n>0&&(0,r.tZ)("div",{className:b().dynamic([["6310b31df33ae425",[Z.TV.borderRadius8,Z.TV.borderRadius8]]])+" unread-icon"}),(0,r.tZ)(b(),{id:"6310b31df33ae425",dynamic:[Z.TV.borderRadius8,Z.TV.borderRadius8],children:".floating-icon-wrapper.__jsx-style-dynamic-selector{height:36px;width:50px;-webkit-border-radius:".concat(Z.TV.borderRadius8," 0 0 ").concat(Z.TV.borderRadius8,";-moz-border-radius:").concat(Z.TV.borderRadius8," 0 0 ").concat(Z.TV.borderRadius8,";border-radius:").concat(Z.TV.borderRadius8," 0 0 ").concat(Z.TV.borderRadius8,";position:absolute;right:0px;bottom:var(--space-16);z-index:10;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;cursor:pointer;opacity:1;-webkit-transition:300ms;-moz-transition:300ms;-o-transition:300ms;transition:300ms}.chat-icon-wrapper.__jsx-style-dynamic-selector{width:32px;height:32px;padding:5px;color:#fff}.unread-icon.__jsx-style-dynamic-selector{position:absolute;top:5px;left:12px;background:red;width:8px;height:8px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;z-index:11}")})]})};function I(){var e=(0,v.Z)("flag-threads-2"),n=(0,l.Z)(),i=(0,s.Z)(n,{onReceiveAnnotationUpdate:function(){}}).unreadThreadCount,a=(0,t.Z)((0,d.KO)(c.c),2),u=a[0],m=a[1],p=function(){u||((0,o.j)(o.U3.THREADS_OPENED,{unread:Boolean(i)}),(0,o.j)(o.U3.MESSAGES_LIST_OPENED,{replId:n,context:"threads",variant:"replace-chat"})),m((function(e){return!e}))};return e?(0,r.tZ)(f,{onClick:p,unreadThreadCount:i,isOpen:u}):(0,r.tZ)(C,{unreadThreadCount:i,onClick:p})}},13122:function(e,n,i){i.d(n,{Z:function(){return c}});var t=i(26042),r=i(69396),a=i(35944),o=(i(67294),i(57731)),l=i(66060),s=i(69346),d=i(81255);function c(e){var n=function(){e.canClick&&e.onClick&&e.onClick({username:e.username,id:e.id})};return(0,a.tZ)(l.ZP,{placement:"bottom",tooltip:"Observe ".concat(e.username),children:function(i,l){return(0,a.tZ)(s.Z,(0,r.Z)((0,t.Z)({},i),{innerRef:l,onClick:n,children:(0,a.tZ)(o.Z,{size:e.size||35,src:e.image,alt:e.username,css:[e.canClick&&d.l0.cursor.pointer,{transition:"all 0.2s ease",border:"2px solid "+e.color,"&:hover":{filter:"brightness(95%)",boxShadow:d.TV.shadow1}}]})}))}})}},55897:function(e,n,i){i.d(n,{e:function(){return s}});var t=i(67294),r=i(54810),a=i(22371),o=i(99408),l=i(65456);function s(){return function(e){var n=(0,r.Z)("flag-tutorial-pane"),i=(0,t.useState)(!1),o=i[0],s=i[1],d=(0,t.useState)(!0),c=d[0],u=d[1];return(0,t.useEffect)((function(){n&&e.watchDir(".",{onChange:function(e){u(!1),s(e.some((function(e){return e.type===l.Tv.Directory&&e.filename===a.V})))},onMoveOrDelete:function(){u(!1),s(!1)},onError:function(){u(!1),s(!1)}})}),[e,n]),n?{loading:c,isTutorial:o}:{loading:!1,isTutorial:!1}}((0,o.Z)().fs)}},50580:function(e,n,i){i.d(n,{Z:function(){return l}});var t=i(15335),r=i(90317),a=i(63377),o=i(5783);function l(){var e=(0,a.Z)(),n=(0,t.Z)();(0,r.LSc)({variables:{replId:e},skip:n!==o.e.CONNECTED})}},44746:function(e,n,i){i.d(n,{Z:function(){return a}});var t=i(67294),r=i(99408);function a(){var e=(0,r.Z)(),n=e.session,i=e.presence;return t.useCallback((function(e){var t=e.username,r=e.id,a=i.getFollowedUser();if((null===a||void 0===a?void 0:a.username)!==t){i.followUser(t);var o=i.getActiveFileForUser(r),l=n.getActiveFile();o&&o!==l&&n.openFile(o)}else i.unfollowUser()}),[n,i])}},99461:function(e,n,i){i.d(n,{$q:function(){return v},Oc:function(){return g},eo:function(){return m},sc:function(){return x}});var t=i(47568),r=i(34051),a=i.n(r),o=i(35642),l=i(90317),s=i(58809),d=i(86292);function c(e){return u.apply(this,arguments)}function u(){return(u=(0,t.Z)(a().mark((function e(n){var i,t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==s.l){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,s.l.query({query:l.vce,variables:{username:n}});case 5:return t=e.sent.data,e.abrupt("return",null===t||void 0===t||null===(i=t.user)||void 0===i?void 0:i.image);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return"Notification"in window?"true"===o.Z.get(b,"string")?"dismissed":window.Notification.permission:"denied"}function p(){return f.apply(this,arguments)}function f(){return(f=(0,t.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,window.Notification.requestPermission().then(),e.next=7;break;case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",new Promise((function(e){window.Notification.requestPermission((function(n){e(n)}))})));case 7:return e.abrupt("return",window.Notification.requestPermission());case 8:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}function v(){return h.apply(this,arguments)}function h(){return(h=(0,t.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:n=e.sent,g(!1),(0,d.j)("granted"===n?d.U3.WEB_NOTIFICATION_PERM_GRANTED:d.U3.WEB_NOTIFICATION_PERM_DENIED);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b="notifications/dismissedModal";function g(e){o.Z.set(b,String(e)),e&&(0,d.j)(d.U3.WEB_NOTIFICATION_PERM_DISMISSED_MODAL)}var Z={};function x(e){return y.apply(this,arguments)}function y(){return(y=(0,t.Z)(a().mark((function e(n){var i,t,r,o,l,s,d,u,p,f,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.title,t=n.body,r=n.badge,o=n.icon,l=n.iconByUsername,s=n.tag,d=n.onClick,u=n.cacheDuration,p=void 0===u?0:u,document.hidden||!document.hasFocus()){e.next=3;break}return e.abrupt("return");case 3:if("granted"===m()){e.next=5;break}return e.abrupt("return");case 5:if(f=Date.now(),!(s in Z)){e.next=9;break}if(!(Z[s]+p>f)){e.next=9;break}return e.abrupt("return");case 9:if(!l){e.next=13;break}return e.next=12,c(l);case 12:o=e.sent;case 13:(v=new window.Notification(i,{body:t,badge:r||"/public/images/logo-grayscale.png",icon:o||"/public/images/icon-square.png",tag:s})).addEventListener("click",(function(){window.focus(),v.close()})),d&&v.addEventListener("click",d),Z[s]=f;case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},23579:function(e,n,i){i.d(n,{Z:function(){return C}});var t=i(35944),r=i(60536),a=i.n(r),o=i(67294),l=i(30019),s=i(19526),d=i(57263),c=i(10253),u=i(29815),m=i(94184),p=i.n(m),f=i(4158),v=i(60219),h=i(86292),b=i(90317),g=i(6951),Z=i(67629),x=i(28898),y=i(93058),w=i(69049),k=i(34847);function j(e){var n=e.replId,i=(0,b.X6F)({variables:{replId:n},pollInterval:8e3}),r=i.data,d=i.loading,m=(0,y.Z)(),j=m.showConfirm,_=m.showError,C=(0,c.Z)(o.useState(!1),2),I=C[0],E=C[1],R=(0,c.Z)((0,b.QNh)({onCompleted:function(e){var i,t=null===(i=e.addMultiplayerUser.user)||void 0===i?void 0:i.username;t&&((0,h.j)(h.U3.MULTIPLAYER_INVITED,{replId:n,inviteMethod:"username"}),j("Added @".concat(t)))}}),2),S=R[0],T=R[1],U=(0,c.Z)((0,b.GkG)({onError:function(e){return _(e.message)},onCompleted:function(e){var i,t=null===(i=e.removeMultiplayerUser.user)||void 0===i?void 0:i.username;t&&((0,h.j)(h.U3.MP2_REMOVED_USER_PERMISSION,{replId:n,username:t}),j("".concat(t," removed")))}}),2),N=U[0],B=U[1],M=(0,c.Z)((0,b.SvR)({update:function(e,i){var t,r=null===(t=i.data)||void 0===t?void 0:t.createMultiplayerInvite2;if(r)if("UserError"!==r.__typename){if("MultiplayerInvite"===r.__typename){var a=r.email;return(0,h.j)(h.U3.MULTIPLAYER_INVITED,{replId:n,inviteMethod:"email"}),void j("Invited ".concat(a," via email"))}if("ReplPermission"===r.__typename){var o;e.modify({id:e.identify({__typename:"Repl",id:n}),fields:{permissions:function(n){var i=e.writeFragment({data:r,fragment:b.L13});return(0,u.Z)(n).concat([i])}}});var l=null===(o=r.user)||void 0===o?void 0:o.username;if(!l)return;(0,h.j)(h.U3.MULTIPLAYER_INVITED,{replId:n,inviteMethod:"email"}),j("Invited @".concat(l))}}else _(r.message)}}),2),D=M[0],P=M[1],X=(0,c.Z)((0,b.Ejz)({onError:function(e){return _(e.message)},onCompleted:function(e){if("UserError"!==e.deleteMultiplayerInvite.__typename){if("MultiplayerInvite"===e.deleteMultiplayerInvite.__typename){var i=e.deleteMultiplayerInvite.email;(0,h.j)(h.U3.MP2_REMOVED_EMAIL_INVITE,{replId:n,email:i}),j("invite for ".concat(i," deleted"))}}else _(e.deleteMultiplayerInvite.message)}}),2),O=X[0],A=X[1];o.useEffect((function(){var e=T.error||P.error;e&&(e.message.includes("reached the limit")?E(!0):_(e.message))}),[T.error,P.error,_]);var z="Repl"===(null===r||void 0===r?void 0:r.repl.__typename)?r.repl:null,G=null===r||void 0===r?void 0:r.currentUser,F=null===z||void 0===z?void 0:z.permissions.reduce((function(e,n){return n.user?(0,u.Z)(e).concat([n.user.username]):e}),[]),V=null===z||void 0===z?void 0:z.currentUserPermissions.editMultiplayers,L=Boolean(z&&!z.permissions.length&&!z.multiplayerInvites.length),W=(null===z||void 0===z?void 0:z.permissions)?z.permissions.length:null;return(0,t.BX)("div",{className:"jsx-7043475ed4bd7433 root",children:[(0,t.BX)(s.gC,{spacing:2,align:"stretch",children:[V&&F&&z?(0,t.tZ)("div",{className:"jsx-7043475ed4bd7433",children:(0,t.tZ)(w.Z,{existingUsernames:F,onSubmit:function(e){!!!e.match(/.+@.+/)||P.loading?T.loading||S({variables:{username:e,replId:z.id,type:"rw"}}):D({variables:{email:e,replId:z.id,type:"rw"}})}})}):null,(0,t.tZ)("div",{className:"jsx-7043475ed4bd7433",children:(0,t.BX)(l.Z,{level:5,foreground:d?3:1,children:[null!==W&&(null===G||void 0===G?void 0:G.isSubscribed)?"".concat((0,k.Z)("multiplayer",W,!0)):null,null===W||(null===G||void 0===G?void 0:G.isSubscribed)?null:"".concat(W,"/").concat(50," ").concat((0,k.Z)("multiplayer",W))," ",!d&&!(null===G||void 0===G?void 0:G.isSubscribed)&&(0,t.tZ)("a",{onClick:function(){return E(!0)},"aria-label":"Click to upgrade for unlimited invites","data-microtip-position":"top",role:"tooltip",className:"jsx-7043475ed4bd7433 info-tooltip",children:(0,t.tZ)(f.Z,{})}),d?"Loading...":null]})}),L?(0,t.tZ)("div",{className:"jsx-7043475ed4bd7433 empty-list",children:(0,t.BX)(s.Ug,{align:"center",justify:"center",children:[(0,t.tZ)("div",{className:"jsx-7043475ed4bd7433",children:"No one is here"}),(0,t.tZ)("div",{className:"jsx-7043475ed4bd7433",children:(0,t.tZ)("img",{src:"/public/images/rainy-computer.png",className:"jsx-7043475ed4bd7433"})})]})}):(0,t.BX)("div",{className:"jsx-7043475ed4bd7433 multiplayers-list",children:[null===z||void 0===z?void 0:z.permissions.map((function(e){var i=e.user,r=e.type;return i?(0,t.BX)("div",{className:"jsx-7043475ed4bd7433 "+(p()("multiplayer-item",{"is-editable":z.currentUserPermissions.editMultiplayers})||""),children:[(0,t.tZ)(x.Z,{size:"s",url:i.image}),(0,t.BX)("div",{className:"jsx-7043475ed4bd7433 label",children:[i.username," ",r===b.aQH.Rw?" (can edit)":null]}),z.currentUserPermissions.editMultiplayers?(0,t.tZ)(g.Z,{border:!1,filled:!1,"aria-label":"Remove member",role:"tooltip","data-microtip-position":"left",onClick:function(){B.loading||N({variables:{replId:n,username:i.username}})},children:(0,t.tZ)(Z.Z,{size:12})}):null]},i.id):null})),null===z||void 0===z?void 0:z.multiplayerInvites.map((function(e){return(0,t.BX)("div",{className:"jsx-7043475ed4bd7433 "+(p()("multiplayer-item",{"is-editable":V})||""),children:[(0,t.tZ)(x.Z,{size:"s"}),(0,t.BX)("div",{className:"jsx-7043475ed4bd7433 label",children:[e.email," (pending)"]}),V?(0,t.tZ)(g.Z,{border:!1,filled:!1,"aria-label":"Remove email invite",role:"tooltip","data-microtip-position":"left",onClick:function(){A.loading||O({variables:{replId:n,email:e.email}})},children:(0,t.tZ)(Z.Z,{size:12})}):null]},e.email)}))]})]}),(0,t.tZ)(v.Z,{isOpen:I,onClose:function(){return E(!1)},trackingInfo:{context:"workspace-multiplayer-header"}}),(0,t.tZ)(a(),{id:"7043475ed4bd7433",children:".root.jsx-7043475ed4bd7433{color:var(--foreground-default)}.multiplayers-list.jsx-7043475ed4bd7433,.empty-list.jsx-7043475ed4bd7433{background-color:var(--background-root);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);height:200px}.multiplayers-list.jsx-7043475ed4bd7433{overflow-y:auto;padding:var(--space-8)0}.multiplayer-item.jsx-7043475ed4bd7433{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;padding:var(--space-4)var(--space-16);-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.multiplayer-item.is-editable.jsx-7043475ed4bd7433{padding-right:var(--space-8)}.multiplayer-item.is-editable.jsx-7043475ed4bd7433:hover{background-color:var(--background-root)}.label.jsx-7043475ed4bd7433{margin-right:auto;padding-left:var(--space-8)}.info-tooltip.jsx-7043475ed4bd7433{display:inline-block}.info-tooltip.jsx-7043475ed4bd7433,.info-tooltip.jsx-7043475ed4bd7433:hover,.info-tooltip.jsx-7043475ed4bd7433:focus{color:var(--foreground-default);border:none;outline:none}.empty-list.jsx-7043475ed4bd7433 img.jsx-7043475ed4bd7433{display:block;height:200px;opacity:60%}"})]})}var _=i(10854);function C(e){var n=e.replId;return(0,t.BX)("div",{className:a().dynamic([["73cdb9c447ce4102",[d.j.mobileMax]]]),children:[(0,t.BX)(s.gC,{spacing:2,align:"stretch",children:[(0,t.tZ)(l.Z,{level:4,children:"Invite"}),(0,t.tZ)(j,{replId:n}),(0,t.tZ)(_.Z,{replId:n})]}),(0,t.tZ)(a(),{id:"73cdb9c447ce4102",dynamic:[d.j.mobileMax],children:"div.__jsx-style-dynamic-selector{padding:var(--space-16)}@media screen and (min-width:".concat(d.j.mobileMax,"px){div.__jsx-style-dynamic-selector{padding:var(--space-32)}}")})]})}},98567:function(e,n,i){i.d(n,{Z:function(){return D}});var t=i(10253),r=i(29815),a=i(35944),o=i(60536),l=i.n(o),s=i(67294),d=i(94184),c=i.n(d),u=i(90317),m=i(19526),p=i(18757),f=i(64184),v=i(82893),h=i(28898),b=i(93058),g=i(67629),Z=i(92002),x=i(30019),y=i(44781),w=i(57263),k=i(27206),j=i(50009),_=i(3218),C=i(69049),I=i(86292),E=i(6951);function R(e){var n=e.value,i=e.onButtonPress,t=e.statusText,r=void 0===t?"":t,o=e.image,s=e.filterValue,d=e.type,u=e.Icon;return(0,a.BX)("div",{className:"jsx-a16e88ad40d0e05c "+(c()("multiplayer-item",{"is-editable":!!i})||""),children:[(0,a.BX)(m.Ug,{align:"center",spacing:1,children:[(0,a.tZ)(h.Z,{size:"s",url:null!==o&&void 0!==o?o:""}),(0,a.tZ)("div",{className:"jsx-a16e88ad40d0e05c label",children:s?(0,a.tZ)(j.gr,{source:n,match:s}):"".concat(n," ").concat(r)}),!!i&&(0,a.tZ)(E.Z,{className:"remove-button",border:!1,filled:!1,"aria-label":"Remove ".concat(d||"email invite"),role:"tooltip","data-microtip-position":"left",onClick:i,children:u&&(0,a.tZ)(u,{size:12,className:"jsx-a16e88ad40d0e05c"})})]}),(0,a.tZ)(l(),{id:"a16e88ad40d0e05c",children:".multiplayer-item.jsx-a16e88ad40d0e05c{padding:var(--space-4)var(--space-16)}.multiplayer-item.is-editable.jsx-a16e88ad40d0e05c{padding-right:var(--space-8)}.multiplayer-item.is-editable.jsx-a16e88ad40d0e05c:hover{background-color:var(--background-root)}.label.jsx-a16e88ad40d0e05c{margin-right:auto}"})]})}var S=i(78135),T=i(4158),U=i(34193);function N(e){var n=e.email,i=e.onInvite,t=e.onCancel;return(0,a.BX)("div",{className:"jsx-1a6ae4ac10e8f1fa root",children:[(0,a.tZ)(x.Z,{level:3,align:"center",children:"Are you sure?"}),(0,a.BX)(y.Z,{align:"center",children:[(0,a.tZ)("p",{className:"jsx-1a6ae4ac10e8f1fa message",children:"Adding an external user as a guest to this repl will give the user read and write access. Please confirm the below email address before inviting the user as a guest."}),(0,a.tZ)("p",{className:"jsx-1a6ae4ac10e8f1fa email",children:n})]}),(0,a.BX)("div",{className:"jsx-1a6ae4ac10e8f1fa controls",children:[(0,a.tZ)(E.Z,{onClick:t,children:"Cancel"}),(0,a.tZ)(E.Z,{filled:!0,color:"primary",onClick:i,children:"Invite"})]}),(0,a.tZ)(l(),{id:"1a6ae4ac10e8f1fa",children:".root.jsx-1a6ae4ac10e8f1fa{color:var(--foreground-default);padding:var(--space-24);display:grid;grid-gap:var(--space-24)}.controls.jsx-1a6ae4ac10e8f1fa{display:grid;grid-gap:var(--space-8);grid-auto-flow:column}.message.jsx-1a6ae4ac10e8f1fa{padding-bottom:var(--space-16)}"})]})}var B=i(10854),M=i(34847);function D(e){var n,i=e.replId,o=(0,u.JT6)({variables:{replId:i}}),d=o.data,E=o.loading,D=(0,S.v9)((function(e){return e.user.userInfo.isLoggedIn?e.user.userInfo.id:null})),P=(0,b.Z)(),X=P.showConfirm,O=P.showError,A=(0,t.Z)(s.useState(""),2),z=A[0],G=A[1],F=(0,t.Z)((0,u.fSO)({onError:function(e){return O(e.message)},onCompleted:function(e){var n=e.addMultiplayerUser.user;(0,I.j)(I.U3.MULTIPLAYER_INVITED,{replId:i,inviteMethod:"username"});var t=n?"@".concat(n.username):"Member";X("".concat(t," added"))}}),2),V=F[0],L=F[1],W=(0,t.Z)((0,u.HMU)({onError:function(e){return O(e.message)},onCompleted:function(e){var n=e.removeMultiplayerUser.user,i=n?"@".concat(n.username):"Member";X("".concat(i," removed"))}}),2),q=W[0],H=W[1],Y="Repl"===(null===d||void 0===d?void 0:d.repl.__typename)?d.repl:null,Q=(0,t.Z)((0,u.SvR)({onError:function(e){O(e.message)},update:function(e,n){var t,a=null===(t=n.data)||void 0===t?void 0:t.createMultiplayerInvite2;if(a)if("UserError"!==a.__typename){if("MultiplayerInvite"===a.__typename){var o=a.email;return(0,I.j)(I.U3.MULTIPLAYER_INVITED,{replId:i,inviteMethod:"email"}),void X("Invited ".concat(o," via email"))}if("ReplPermission"===a.__typename){e.modify({id:e.identify({__typename:"Repl",id:i}),fields:{permissions:function(n){var i=e.writeFragment({data:a,fragment:u.L13});return(0,r.Z)(n).concat([i])}}});var l=a.user;(0,I.j)(I.U3.MULTIPLAYER_INVITED,{replId:i,inviteMethod:"email"});var s=l?"@".concat(l.username):"Member";X("".concat(s," added"))}}else O(a.message)}}),2),J=Q[0],K=Q[1],$=(0,t.Z)((0,u.Ejz)({onError:function(e){return O(e.message)},onCompleted:function(e){if("UserError"!==e.deleteMultiplayerInvite.__typename){if("MultiplayerInvite"===e.deleteMultiplayerInvite.__typename){var n=e.deleteMultiplayerInvite.email;(0,I.j)(I.U3.MP2_REMOVED_EMAIL_INVITE,{replId:i,email:n}),X("Invite for ".concat(n," deleted"))}}else O(e.deleteMultiplayerInvite.message)}}),2),ee=$[0],ne=$[1];if(Y&&!Y.owner)throw new Error("Cannot manage members on anon repls");if((null===Y||void 0===Y?void 0:Y.owner)&&"Team"!==(null===Y||void 0===Y?void 0:Y.owner.__typename))throw new Error("Expect repl owned by a team");var ie,te,re,ae="Team"===(null===Y||void 0===Y||null===(n=Y.owner)||void 0===n?void 0:n.__typename)?Y.owner:null,oe=null!==(ie=null===Y||void 0===Y?void 0:Y.permissions.reduce((function(e,n){return n.user?(0,r.Z)(e).concat([n.user.username]):e}),[]))&&void 0!==ie?ie:[],le=null===Y||void 0===Y?void 0:Y.permissions.reduce((function(e,n){if(!n.user)return e;var i=n.user;return!z||_.Z.filter(z,[i.username]).length>0?((null===ae||void 0===ae?void 0:ae.members.some((function(e){var n;return(null===(n=e.user)||void 0===n?void 0:n.id)===i.id})))||e.users.push(i),e):e}),{users:[]}),se=null===Y||void 0===Y?void 0:Y.multiplayerInvites.filter((function(e){return!z||_.Z.filter(z,[e.email]).length>0})),de=null===ae||void 0===ae?void 0:ae.members.reduce((function(e,n){if(!n.user)return e;var i=n.user;if(!(!z||_.Z.filter(z,[i.username]).length>0))return e;var t=n.permissions&&n.permissions!==u.SV1.Member,r=null===Y||void 0===Y?void 0:Y.permissions.find((function(e){var n;return e.user&&(null===(n=e.user)||void 0===n?void 0:n.id)===i.id}));return t?e.teamAdmins.push(i):(null===r||void 0===r?void 0:r.type)?e.withPermission.push(i):e.withoutPermission.push(i),e}),{teamAdmins:[],withPermission:[],withoutPermission:[]}),ce=null===de||void 0===de?void 0:de.teamAdmins.some((function(e){return e.id===D})),ue=(null!==(te=null===le||void 0===le?void 0:le.users.length)&&void 0!==te?te:0)+(null!==(re=null===se||void 0===se?void 0:se.length)&&void 0!==re?re:0),me=null===Y||void 0===Y?void 0:Y.currentUserPermissions.editMultiplayers,pe=null===Y||void 0===Y?void 0:Y.currentUserPermissions.inviteGuests,fe=Boolean(de&&!de.teamAdmins.length&&!de.withPermission.length&&(!(null===le||void 0===le?void 0:le.users.length)&&!(null===se||void 0===se?void 0:se.length)&&pe||!pe&&!de.withoutPermission.length)),ve=(0,t.Z)(s.useState(null),2),he=ve[0],be=ve[1];return(0,a.BX)("div",{className:l().dynamic([["dc131772cdbb2add",[w.j.mobileMax]]])+" root",children:[(0,a.BX)(m.gC,{spacing:2,align:"stretch",children:[(0,a.BX)(m.Ug,{children:[(0,a.BX)(x.Z,{level:5,foreground:E?3:1,children:[me?"Add or remove members from this repl":null,E?"Loading...":null]}),me&&pe&&!E&&(0,a.tZ)("div",{"aria-label":" Add team members or invite external guests via email or username","data-microtip-position":"bottom","data-microtip-size":"medium",role:"tooltip",className:l().dynamic([["dc131772cdbb2add",[w.j.mobileMax]]])+" information-icon-container",children:(0,a.tZ)(T.Z,{})})]}),pe?(0,a.tZ)(C.Z,{existingUsernames:oe,onSubmit:function(e){!!e.match(/.+@.+/)&&!K.loading?be(e):L.loading||V({variables:{username:e,replId:i,type:"rw"}}),G("")},placeholder:me?"Search for users or invite guests":"Filter users",isDisabled:E,onChange:function(e){return G(e)}}):(0,a.tZ)(k.ZP,{disabled:E,value:z,onChange:function(e){return G(e.currentTarget.value)},placeholder:me?"Filter team members to add or remove":"Filter team members"}),(0,a.tZ)(U.Z,{isOpen:!!he,onRequestClose:function(){return be(null)},children:he?(0,a.tZ)(N,{email:he,onInvite:function(){J({variables:{email:he,replId:i,type:"rw"}}),be(null)},onCancel:function(){return be(null)}}):null}),(0,a.BX)("div",{className:l().dynamic([["dc131772cdbb2add",[w.j.mobileMax]]])+" "+(c()("multiplayers-list",{"is-empty":fe})||""),children:[(null===de||void 0===de?void 0:de.withPermission.length)?(0,a.tZ)("div",{className:l().dynamic([["dc131772cdbb2add",[w.j.mobileMax]]])+" list-heading",children:(0,a.BX)(m.Ug,{align:"center",spacing:1,children:[(0,a.tZ)(p.Z,{size:12}),(0,a.BX)(y.Z,{foreground:2,size:"small",children:[null===de||void 0===de?void 0:de.withPermission.length," member",1===(null===de||void 0===de?void 0:de.withPermission.length)?"":"s"," with access"]})]})}):null,null===de||void 0===de?void 0:de.withPermission.map((function(e){return(0,a.tZ)(R,{value:e.username,image:e.image,statusText:"(can edit)",type:"member",onButtonPress:ce?function(){H.loading||q({variables:{replId:i,username:e.username}})}:void 0,Icon:g.Z},e.id)})),!!ue&&(0,a.tZ)("div",{className:l().dynamic([["dc131772cdbb2add",[w.j.mobileMax]]])+" list-heading",children:(0,a.BX)(m.Ug,{align:"center",spacing:1,children:[(0,a.tZ)(p.Z,{size:12}),(0,a.BX)(y.Z,{foreground:2,size:"small",children:[(0,M.Z)("guest",ue,!0),"with access"]})]})}),null===le||void 0===le?void 0:le.users.map((function(e){return(0,a.tZ)(R,{value:e.username,image:e.image,statusText:"(can edit)",type:"guest",onButtonPress:ce?function(){H.loading||q({variables:{replId:i,username:e.username}})}:void 0,Icon:g.Z},e.id)})),null===se||void 0===se?void 0:se.map((function(e){return(0,a.tZ)(R,{value:e.email,statusText:"(pending)",onButtonPress:ce?function(){ne.loading||ee({variables:{replId:i,email:e.email}})}:void 0,Icon:g.Z},e.email)})),!pe&&(null===de||void 0===de?void 0:de.withoutPermission.length)?(0,a.tZ)("div",{className:l().dynamic([["dc131772cdbb2add",[w.j.mobileMax]]])+" list-heading",children:(0,a.BX)(m.Ug,{align:"center",spacing:1,children:[(0,a.tZ)(f.Z,{size:12}),(0,a.BX)(y.Z,{foreground:2,size:"small",children:[(0,M.Z)("member",null===de||void 0===de?void 0:de.withoutPermission.length,!0),"without access"]})]})}):null,!pe&&(null===de||void 0===de?void 0:de.withoutPermission.map((function(e){return(0,a.tZ)(R,{value:e.username,image:e.image,type:"member",onButtonPress:me?function(){L.loading||V({variables:{replId:i,username:e.username,type:"rw"}})}:void 0,Icon:Z.Z},e.id)}))),(null===de||void 0===de?void 0:de.teamAdmins.length)?(0,a.tZ)("div",{className:l().dynamic([["dc131772cdbb2add",[w.j.mobileMax]]])+" list-heading",children:(0,a.BX)(m.Ug,{align:"center",spacing:1,children:[(0,a.tZ)(v.Z,{size:12}),(0,a.tZ)(y.Z,{foreground:2,size:"small",children:"Team admins cannot be removed from repls"})]})}):null,null===de||void 0===de?void 0:de.teamAdmins.map((function(e){return(0,a.tZ)("div",{className:l().dynamic([["dc131772cdbb2add",[w.j.mobileMax]]])+" "+(c()("multiplayer-item",{"is-editable":me})||""),children:(0,a.BX)(m.Ug,{align:"center",spacing:1,children:[(0,a.tZ)(h.Z,{size:"s",url:e.image}),(0,a.tZ)("div",{className:l().dynamic([["dc131772cdbb2add",[w.j.mobileMax]]])+" label",children:z?(0,a.tZ)(j.gr,{source:e.username,match:z}):e.username})]})},e.id)})),fe?(0,a.BX)(y.Z,{foreground:2,align:"center",children:['No members matching "',z,'" found']}):null]}),me||E?null:(0,a.tZ)(y.Z,{foreground:2,size:"small",children:"Only admins can add and remove members to multiplayer"}),me&&pe&&(0,a.tZ)(B.Z,{replId:i})]}),(0,a.tZ)(l(),{id:"dc131772cdbb2add",dynamic:[w.j.mobileMax],children:".root.__jsx-style-dynamic-selector{padding:var(--space-16);color:var(--foreground-default)}.multiplayers-list.__jsx-style-dynamic-selector{background-color:var(--background-root);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);height:300px;overflow-y:auto}.multiplayers-list.is-empty.__jsx-style-dynamic-selector{display:grid;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:var(--space-16);word-break:break-word}.multiplayer-item.__jsx-style-dynamic-selector{padding:var(--space-4)var(--space-16)}.multiplayer-item.is-editable.__jsx-style-dynamic-selector{padding-right:var(--space-8)}.multiplayer-item.is-editable.__jsx-style-dynamic-selector:hover{background-color:var(--background-root)}.list-heading.__jsx-style-dynamic-selector{padding:var(--space-16)var(--space-16)0}.label.__jsx-style-dynamic-selector{margin-right:auto}.information-icon-container.__jsx-style-dynamic-selector{margin-left:5px}@media screen and (min-width:".concat(w.j.mobileMax,"px){.root.__jsx-style-dynamic-selector{padding:var(--space-48)}}")})]})}},69049:function(e,n,i){i.d(n,{Z:function(){return y}});var t=i(26042),r=i(69396),a=i(10253),o=i(35944),l=i(60536),s=i.n(l),d=i(67294),c=i(94184),u=i.n(c),m=i(96594),p=i(27206),f=i(6951),v=i(24351),h=i(90317),b=i(93058),g=i(19526),Z=i(88075),x=i(28898);function y(e){var n=e.onSubmit,i=e.existingUsernames,l=e.isDisabled,c=e.onChange,y=e.placeholder,w=(0,a.Z)(d.useState(""),2),k=w[0],j=w[1],_=!!k.match(/.+@.+/),C=(0,v.Z)(k.trim().replace(/^@/,""),250),I=(0,h.skk)({skip:!C||_,variables:{query:C,limit:6}}),E=I.data,R=I.loading,S=I.error,T=(0,b.Z)().showError;d.useEffect((function(){S&&T(S.message)}),[S,T]);var U=null===E||void 0===E?void 0:E.usernameSearch;return(0,o.BX)("form",{onSubmit:function(e){e.preventDefault(),n(k),j("")},className:"jsx-d408485a86637a91",children:[(0,o.BX)("div",{className:"jsx-d408485a86637a91 form-content",children:[(0,o.tZ)(m.ZP,{onChange:function(e){e&&j(e.username)},itemToString:function(e){return(null===e||void 0===e?void 0:e.username)||""},initialHighlightedIndex:0,defaultHighlightedIndex:0,children:function(e){var a=e.getInputProps,l=e.getItemProps,s=e.getMenuProps,d=e.isOpen,m=e.highlightedIndex;return(0,o.BX)("div",{className:"jsx-d408485a86637a91 dropdown",children:[(0,o.tZ)(p.ZP,(0,t.Z)({},a({ref:null,value:k,onChange:function(e){j(e.currentTarget.value),null===c||void 0===c||c(e.currentTarget.value)},placeholder:null!==y&&void 0!==y?y:"Search by username or invite by email",autoComplete:"off",onKeyDown:function(e){"Enter"===e.key&&k.match(/.+@.+/)&&(n(k),j(""),e.currentTarget.blur())}}))),(0,o.BX)("div",(0,r.Z)((0,t.Z)({},s()),{className:"jsx-d408485a86637a91",children:[d&&U&&U.length?(0,o.tZ)("div",{className:"jsx-d408485a86637a91 dropdown-menu",children:U.map((function(e,n){return(0,o.tZ)("div",(0,r.Z)((0,t.Z)({},l({item:e,index:n})),{className:"jsx-d408485a86637a91 "+(u()("result",{"is-active":m===n})||""),children:(0,o.BX)(g.Ug,{align:"center",spacing:1,children:[(0,o.tZ)(x.Z,{size:"s",url:e.image}),(0,o.tZ)("div",{className:"jsx-d408485a86637a91",children:e.username}),i.includes(e.username)?(0,o.tZ)("div",{className:"jsx-d408485a86637a91 check-icon",children:(0,o.tZ)(Z.Z,{})}):null]})}),e.username)}))}):null,d&&R?(0,o.tZ)("div",{className:"jsx-d408485a86637a91 dropdown-menu is-loading",children:"loading..."}):null,d&&U&&0===U.length?(0,o.BX)("div",{className:"jsx-d408485a86637a91 dropdown-menu is-empty",children:['no results found for "',k,'"']}):null]}))]})}}),(0,o.tZ)("div",{className:"jsx-d408485a86637a91",children:(0,o.tZ)(f.Z,{color:"primary",type:"submit",filled:!0,disabled:l||!k,children:"Invite"})})]}),(0,o.tZ)(s(),{id:"d408485a86637a91",children:".form-content.jsx-d408485a86637a91{display:grid;position:relative;width:100%;grid-template-columns:1fr auto;grid-column-gap:var(--space-8);-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.dropdown.jsx-d408485a86637a91{position:relative;z-index:5}.dropdown-menu.jsx-d408485a86637a91{position:absolute;z-index:1;top:100%;left:0;width:100%;background-color:var(--background-default);border:1px solid var(--foreground-dimmest);border-top:0 none;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);max-height:300px;overflow:auto}.dropdown-menu.is-loading.jsx-d408485a86637a91,.dropdown-menu.is-empty.jsx-d408485a86637a91{color:var(--foreground-dimmer);padding:var(--space-8)}.dropdown.jsx-d408485a86637a91:focus-within .dropdown-menu.jsx-d408485a86637a91{border-color:var(--accent-primary-default)}.spacer.jsx-d408485a86637a91{width:var(--space-8);pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.result.jsx-d408485a86637a91{cursor:pointer;padding:var(--space-8)var(--space-16)}.result.jsx-d408485a86637a91:hover,.is-active.jsx-d408485a86637a91{background-color:var(--accent-primary-dimmer)}.check-icon.jsx-d408485a86637a91{margin-left:auto;color:var(--accent-positive-default)}"})]})}},80314:function(e,n,i){function t(e){var n={};return e.lite&&(n.lite=e.lite),e.classroom_template&&(n.classroom_template=e.classroom_template),e.outputonly&&(n.outputonly=e.outputonly),e.fileName&&(n.fileName=e.fileName),e.debug&&(n.debug=e.debug),e.inspector&&(n.inspector=e.inspector),e.fallback&&(n.fallback=e.fallback),e.vcr&&(n.vcr=e.vcr),n}i.d(n,{Z:function(){return t}})},21e3:function(e,n,i){i.d(n,{Z:function(){return m}});var t=i(47568),r=i(34051),a=i.n(r),o=i(67294),l=i(58809),s=i(90317),d=i(99408),c=i(99461);function u(){return(u=(0,t.Z)(a().mark((function e(n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.l){e.next=2;break}throw new Error("Expected Apollo client");case 2:return e.next=4,l.l.query({query:s.UxF,variables:{id:n}});case 4:return i=e.sent.data,e.abrupt("return","Repl"===(null===i||void 0===i?void 0:i.repl.__typename)?i.repl.title:null);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){var e=(0,d.Z)(),n=e.container,i=e.presence;o.useEffect((function(){var e=i.onUserJoin((function(i){var t,r=null===(t=n.getContext())||void 0===t?void 0:t.repl;if(r){var a=i.username;return function(e){return u.apply(this,arguments)}(r.id).then((function(e){e&&(0,c.sc)({title:"",body:"".concat(a," joined ").concat(e),tag:"".concat(r.id,"-").concat(a,"-joined"),iconByUsername:a,cacheDuration:9e5})})),function(){e()}}}))}),[i,n])}},53852:function(e,n,i){i.d(n,{Z:function(){return a}});var t=i(67294),r=i(10129);function a(){t.useEffect((function(){var e=function(e){"s"===e.key&&(0,r.j)(e)&&e.preventDefault()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[])}},56232:function(e,n,i){i.d(n,{Z:function(){return a}});var t=i(63377),r=i(90317);function a(e){var n=e.isAnon,i=e.isOwner,a=e.ignoreUnloadPrompt,o=(0,t.Z)();(0,r.Vgw)({skip:n||i,variables:{replId:o},onSubscriptionData:function(e){var n;!1===(null===(n=e.subscriptionData.data)||void 0===n?void 0:n.currentUserCanWrite)&&(a(!0),window.location.reload())}})}},83965:function(e,n,i){i.d(n,{Z:function(){return c}});var t=i(29815),r=i(67294),a=i(63377),o=i(90317),l=i(99408),s=i(61374),d=i(15240);function c(){var e=(0,a.Z)(),n=(0,l.Z)().container,i=(0,o.Uv9)({variables:{replId:e}}).data,c=null===i||void 0===i?void 0:i.repl;(0,r.useEffect)((function(){if(c){var e,i=null!==c.origin,r=new Date(c.timeUpdated).getTime()-new Date(c.timeCreated).getTime()<1e3;if(i&&r)(e=n).exec.apply(e,(0,t.Z)(s.rO.format(d.Xe)))}}),[n,c])}},43410:function(e,n,i){i.d(n,{Z:function(){return l}});var t=i(67294),r=i(99408),a=i(86292),o=i(95716);function l(){var e=(0,r.Z)().presence;t.useEffect((function(){return e.onFollowingUsersChanged((function(e){var n=e.followingUsers,i=e.type,t=n.length;"follow"===i?(0,a.j)(o.U.REMOTE_USER_CURSOR_FOLLOWED,{numFollowers:t}):(0,a.j)(o.U.REMOTE_USER_CURSOR_UNFOLLOWED,{numFollowers:t})}))}),[e])}},42511:function(e,n,i){i.d(n,{Z:function(){return f}});var t=i(10253),r=i(35944),a=i(67294),o=i(30019),l=i(44781),s=i(19526),d=i(70804),c=i(15153),u=i(6951),m=i(86292),p=i(49108);function f(e){var n=e.children,i=e.showPopover,f=(0,p.Z)("announcement","add-guest-new-user"),v=f.shouldDisplay,h=f.register,b=f.dismiss,g=(0,t.Z)(a.useState(!1),2),Z=g[0],x=g[1],y=(0,t.Z)(a.useState(!1),2),w=y[0],k=y[1];a.useEffect((function(){i&&!w&&h()}),[w,h,i]);var j=v&&!w;return(0,r.BX)(d.Z,{onClickOutside:function(){return k(!0)},isOpen:j,showArrow:!0,borderColor:"var(--accent-purple-default)",children:[n,(0,r.BX)(s.gC,{spacing:2,align:"stretch",children:[(0,r.BX)(s.Ug,{spacing:1,children:[(0,r.tZ)(c.Z,{}),(0,r.tZ)(o.Z,{level:5,children:"Invite guests to your repl!"})]}),(0,r.BX)(l.Z,{children:[" ","Add external guests to your repl for interviews and collaborative projects."," "]}),(0,r.tZ)(s.Ug,{spacing:1,justify:"end",children:(0,r.tZ)(u.Z,{loading:Z,onClick:function(){x(!0),(0,m.j)(m.U3.ADD_GUEST_POPOVER_DISMISSED),b()},children:"Got it"})})]})]})}},64879:function(e,n,i){i.d(n,{Z:function(){return o}});var t=i(10253),r=i(67294),a=i(99408);function o(){var e=(0,a.Z)().presence,n=(0,t.Z)(r.useState(e.getFollowingUsers()),2),i=n[0],o=n[1];return r.useEffect((function(){return o(e.getFollowingUsers()),e.onFollowingUsersChanged((function(e){o(e.followingUsers)}))}),[e]),i}},41107:function(e,n,i){i.d(n,{Z:function(){return m}});var t=i(35944),r=i(51438),a=44100,o=32896,l=function e(){var n=this;(0,r.Z)(this,e),this.audioStart=0,this.feed=function(e){var i=n.getFormatedValue(e),t=new Float32Array(n.samples.length+i.length);t.set(n.samples,0),t.set(i,n.samples.length),n.samples=t},this.getFormatedValue=function(e){for(var n=new Float32Array(e.length),i=0;i<e.length;i++)n[i]=e[i]/2147483648;return n},this.stop=function(){if(n.bufferSource)try{n.bufferSource.stop()}catch(e){if("InvalidStateError"!==e.name&&"RangeError"!==e.name)throw e}},this.flush=function(e){if(n.audioCtx&&n.samples.length){var i=0,t=n.audioCtx.currentTime;if(0===e)n.startTime=t,n.audioStart=t;else{for(var r=t-n.audioStart,l=Math.floor(r*a);l>e-o;)n.audioStart+=.7459410430839002,l-=o;l>e&&(i=l-e,n.startTime=t),n.startTime=t}n.samples=n.samples.slice(i,n.samples.length);for(var s,d,c,u=n.audioCtx.createBufferSource(),m=n.samples.length/1,p=n.audioCtx.createBuffer(1,m,a),f=0;f<1;f++)for(s=p.getChannelData(f),d=f,c=0;c<m;c++)s[c]=n.samples[d],d+=1;n.startTime<n.audioCtx.currentTime&&(n.startTime=n.audioCtx.currentTime),u.buffer=p,u.connect(n.gainNode),u.start(n.startTime),n.stop(),n.bufferSource=u,n.startTime+=p.duration,n.samples=new Float32Array}},this.samples=new Float32Array;var i=window.AudioContext||window.webkitAudioContext;this.audioCtx=new i,this.gainNode=this.audioCtx.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioCtx.destination),this.startTime=this.audioCtx.currentTime},s=i(86292),d=i(67294),c=i(60731),u=i(88075);function m(e){var n=e.container,i=(0,d.useState)(!1),r=i[0],a=i[1],o=(0,d.useRef)(null);(0,d.useEffect)((function(){return n.openChannel({name:"audio",service:"audio"},(function(e){var n=e.channel;if(n){var i=null,t=!1;return n.onCommand((function(e){var n;t||(t=!0,(0,s.j)(s.U3.AUDIO_PLAYING_STARTED),o.current=function(){i=new l,o.current=null},a(!0)),i&&(null===e||void 0===e||null===(n=e.audio2)||void 0===n?void 0:n.data)&&(e.audio2.samples||(e.audio2.samples=0),i.feed(Int32Array.from(e.audio2.data)),i.flush(e.audio2.samples))})),function(){a(!1),i&&(i.stop(),i=null),o.current=null}}}))}),[n]);var m=function(){a(!1),(0,s.j)(s.U3.AUDIO_PROMPT_CLOSED,{accepted:!1})};return(0,t.tZ)(c.u_,{isOpen:r,onRequestClose:m,children:(0,t.BX)(c.G7,{css:[c.l0.colWithGap(24)],children:[(0,t.tZ)(c.h4,{variant:"headerDefault",level:1,children:"We hear audio!"}),(0,t.BX)(c.G7,{css:[c.l0.colWithGap(8)],children:[(0,t.tZ)(c.xv,{multiline:!0,children:"Hey! It appears that this Repl is playing audio."}),(0,t.tZ)(c.xv,{multiline:!0,children:"In order for us to hear the audio you\u2019re receiving, please click confirm."})]}),(0,t.BX)(c.G7,{css:[c.l0.rowWithGap(12),c.l0.justify.end],children:[(0,t.tZ)(c.zx,{onClick:m,text:"Cancel"}),(0,t.tZ)(c.zx,{colorway:"positive",onClick:function(){a(!1),(0,s.j)(s.U3.AUDIO_PROMPT_CLOSED,{accepted:!0}),o.current&&o.current()},text:"Confirm",iconLeft:(0,t.tZ)(u.Z,{})})]})]})})}},30942:function(e,n,i){i.d(n,{Z:function(){return u}});var t=i(86292),r=i(67294),a=i(68122),o=i(99408),l=i(39571),s=i(63377),d=i(90317),c=i(98705);function u(e){var n=e.onOpenFile,i=e.onOutput,u=(0,o.Z)(),m=u.debuggest,p=u.dotReplit,f=(0,s.Z)(),v=(0,d.NJw)({variables:{replId:f}}).data,h=function(e){var n=e.repl,i=e.dotReplit,t=e.debuggest;return(0,r.useEffect)((function(){if(n){if(!n.lang.hasDAP)return i.watch((function(e){var n;e.error||(null===(n=e.config.debugger)||void 0===n?void 0:n.support)&&t.connect()}));t.connect()}}),[n,t]),(0,a.Z)(t.mainClient)}({debuggest:m,dotReplit:p,repl:"Repl"===(null===v||void 0===v?void 0:v.repl.__typename)?v.repl:null});!function(e){(0,r.useEffect)((function(){if(e){var n=e.onStarted((function(e){(0,t.j)(t.U3.DEBUGGER_USED,{action:"started",joined:e})})),i=e.onPaused((function(e){(0,t.j)(t.U3.DEBUGGER_USED,{action:"paused",reason:e})})),r=e.onBreakpoint((function(n){(0,t.j)(t.U3.DEBUGGER_USED,{action:"breakpointToggled",breakpointAction:n,state:e.state.current})}));return function(){n(),i(),r()}}}),[e])}(h),function(e,n){var i,t=n.onOutput,o=n.onOpenFile,s=(0,c.Z)(t),d=(0,c.Z)(o);(0,r.useEffect)((function(){if(e)return e.onOutput((function(e){s.current(e)}))}),[e]);var u=(0,a.Z)(e?e.stackFrames:null),m=null===u||void 0===u?void 0:u[0],p=null===m||void 0===m||null===(i=m.source)||void 0===i?void 0:i.path,f=null===m||void 0===m?void 0:m.line;(0,r.useEffect)((function(){if(p&&f&&e){var n=(0,l.om)(p);n?d.current({path:n,line:f}):e.stepOut()}}),[e,p,f])}(h,{onOpenFile:n,onOutput:i})}},9068:function(e,n,i){i.d(n,{Z:function(){return m}});var t=i(10253),r=i(35944),a=i(60536),o=i.n(a),l=(i(67294),i(90317)),s=i(13122),d=i(44781),c=i(19526),u=i(64879);function m(){var e=(0,u.Z)();return 0===e.length?null:1===e.length?(0,r.tZ)(p,{user:e[0]}):(0,r.BX)("div",{className:"jsx-4f2e88846001c10e followed-indicator",children:[(0,r.BX)(d.Z,{children:[e.length," users are observing you"]}),(0,r.tZ)(o(),{id:"4f2e88846001c10e",children:".followed-indicator.jsx-4f2e88846001c10e{white-space:nowrap;height:100%;max-width:100%;width:-webkit-max-content;width:-moz-max-content;width:max-content;padding-left:var(--space-8);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}"})]})}function p(e){var n=e.user,i=(0,l.qC4)({variables:{ids:[n.id]},ssr:!1}).data;if(!i)return null;var a=i.usersByIds,u=(0,t.Z)(a,1)[0].image,m=n.id,p=n.username,f=n.color;return(0,r.BX)("div",{className:"jsx-add9eb548244268a followed-indicator",children:[(0,r.BX)(c.Ug,{wrap:"nowrap",align:"center",className:"stack",spacing:"var(--space-4)",children:[(0,r.tZ)(s.Z,{id:m,username:p,image:u,color:f,size:22}),(0,r.tZ)(d.Z,{className:"username",children:p}),(0,r.tZ)("div",{className:"jsx-add9eb548244268a text",children:(0,r.tZ)(d.Z,{children:"is observing you"})})]}),(0,r.tZ)(o(),{id:"add9eb548244268a",children:".followed-indicator.jsx-add9eb548244268a{height:100%;max-width:100%;width:-webkit-max-content;width:-moz-max-content;width:max-content;padding-left:var(--space-8)}.text.jsx-add9eb548244268a{white-space:nowrap}.followed-indicator.jsx-add9eb548244268a .stack{height:100%}.followed-indicator.jsx-add9eb548244268a .username{overflow:clip;max-width:150px;display:inline-block;-o-text-overflow:ellipsis;text-overflow:ellipsis}"})]})}},34955:function(e,n,i){i.d(n,{Z:function(){return v}});var t=i(10253),r=i(35944),a=i(60536),o=i.n(a),l=(i(67294),i(90317)),s=i(99408),d=i(13122),c=i(44781),u=i(67629),m=i(6951),p=i(19526),f=i(34140);function v(e){var n=e.id,i=e.username,a=e.color,v=(0,s.Z)().presence,h=(0,l.qC4)({variables:{ids:[n]},ssr:!1}).data;if(!h)return null;var b=h.usersByIds,g=(0,t.Z)(b,1)[0].image;return(0,r.BX)("div",{className:o().dynamic([["48dd00c96a834430",[a]]])+" following-indicator",children:[(0,r.BX)(p.Ug,{wrap:"nowrap",className:"stack",spacing:"var(--space-4)",children:[(0,r.tZ)(p.gC,{className:"stack",align:"center",justify:"center",children:(0,r.tZ)(d.Z,{id:n,username:i,image:g,color:a,size:22})}),(0,r.tZ)(p.gC,{className:"text-container",align:"center",justify:"center",children:(0,r.BX)(c.Z,{className:"following-text",children:["Observing ",i]})}),(0,r.tZ)(p.gC,{className:"stack",align:"center",justify:"center",children:(0,r.BX)(m.Z,{size:"small",filled:!1,border:!1,textColor:a,onClick:function(){v.unfollowUser()},children:[(0,r.tZ)(f.T,{children:"stop observing"}),(0,r.tZ)(u.Z,{})]})})]}),(0,r.tZ)(o(),{id:"48dd00c96a834430",dynamic:[a],children:".following-indicator.__jsx-style-dynamic-selector{height:100%;max-width:100%;width:-webkit-max-content;width:-moz-max-content;width:max-content;padding-left:var(--space-8)}.following-indicator.__jsx-style-dynamic-selector .stack{height:100%;max-width:100%;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;overflow:clip}.following-indicator.__jsx-style-dynamic-selector .text-container{height:100%;margin-right:-2px}.following-indicator.__jsx-style-dynamic-selector .following-text{color:".concat(a,";white-space:nowrap}")})]})}},65389:function(e,n,i){var t=i(35944),r=(i(67294),i(61756)),a=i(1879),o=i(67629),l=i(69346),s=i(1144),d=i(81255),c=i(88075);n.Z=function(e){return(0,t.tZ)(a.Z,{preventClose:!0,isOpen:!0,onRequestClose:e.onCancel,children:(0,t.BX)(l.Z,{css:[d.l0.colWithGap(24)],children:[(0,t.tZ)(s.h,{variant:"headerDefault",level:2,css:d.l0.maxWidth("100%"),children:"Replit needs your permission to enable notifications."}),(0,t.tZ)(s.x,{multiline:!0,children:"Never miss messages from your collaborators if you\u2019re in another tab or window."}),(0,t.BX)(l.Z,{css:[d.l0.rowWithGap(12),d.l0.justify.end],children:[(0,t.tZ)(r.ZP,{onClick:e.onCancel,text:"Deny",iconLeft:(0,t.tZ)(o.Z,{})}),(0,t.tZ)(r.ZP,{text:"Allow notifications",colorway:"positive",iconLeft:(0,t.tZ)(c.Z,{}),onClick:e.onConfirm})]})]})})}},26082:function(e,n,i){var t=i(5152),r=i.n(t);n.Z=r()((function(){return Promise.all([i.e(4885),i.e(8966),i.e(9710),i.e(3220),i.e(6063),i.e(7571)]).then(i.bind(i,84511)).then((function(e){return e.EditReplTemplate}))}),{loadableGenerated:{webpack:function(){return[84511]}}})},23083:function(e,n,i){i.d(n,{PZ:function(){return b},gn:function(){return Z},$k:function(){return x},vF:function(){return g}});var t=i(26042),r=i(69396),a=i(35944),o=i(67294),l=i(70917),s=i(60731),d=i(67629),c=i(99408),u=i(65456),m=i(47589),p=i(37432);var f=i(1855),v={base:(0,l.iv)([s.l0.display.inlineFlex,s.l0.height("100%"),s.l0.color.foregroundDimmer,s.l0.borderRadius(8),{border:"1px solid transparent",transition:"0.2s background-color",":focus":{borderColor:s.TV.accentPrimaryDefault,outline:"2px solid transparent",outlineOffset:"4px",":not(:focus-visible)":{outline:"none",borderColor:"transparent"}}}]),active:(0,l.iv)([s.l0.color.foregroundDefault,{borderColor:s.TV.outlineDimmest}]),inactive:(0,l.iv)({"&:hover":[s.l0.color.foregroundDefault,{borderColor:s.TV.outlineDimmest}]})},h=(0,l.iv)([s.l0.cursor.pointer,s.l0.justify.center,s.l0.pl(8),s.l0.pr(4),s.l0.height("100%"),{backgroundColor:"transparent",border:"none",font:"inherit",lineHeight:"normal",color:"inherit"}]);function b(e){var n=e.onClick;return(0,a.tZ)(s.hU,{tooltipHidden:!0,onClick:n,alt:"Close",size:18,css:[{"&& svg":{width:12,height:12,minWidth:"unset",minHeight:"unset"},borderRadius:6}],children:(0,a.tZ)(d.Z,{})})}function g(e){var n=(0,c.Z)().fs,i=e.split("/"),t=i.pop(),r=i.join("/"),a=(0,o.useState)(!1),l=a[0],s=a[1],d=function(e){var n=e.path,i=e.initialExpanded,t=(0,c.Z)().fs;return(0,p.Z)({path:n,initialExpanded:i,fs:t})}({path:r.length>0?r:".",initialExpanded:!0}).children,u=null===d||void 0===d?void 0:d.filter((function(e){return e.filename!==t}));return{fileName:t,parentPath:r,renaming:l,siblings:u,handleRename:function(){s(!0)},handleCancel:function(){s(!1)},handleSubmit:function(i){var t=r.length>0?r+"/"+i:i;n.moveFile(e,t),s(!1)}}}function Z(e){var n=e.filePath,i=e.onClick,o=e.onClose,l=e.isActive,d=e.innerRef,c=g(n),p=c.fileName,Z=c.parentPath,x=c.renaming,y=c.siblings,w=c.handleRename,k=c.handleSubmit,j=c.handleCancel;return(0,a.tZ)(s.u,{tooltip:n,placement:"bottom",isDisabled:!Z,children:function(e,n){return(0,a.BX)(s.Tg,(0,r.Z)((0,t.Z)({innerRef:(0,f.l)(d,n),elevated:l,css:[v.base,l?v.active:v.inactive,s.l0.flex.row,s.l0.align.center,s.l0.pr(4)]},e),{children:[x?(0,a.tZ)(m.Z,{onSubmit:k,onCancel:j,loading:!1,siblings:y||[],parentPath:Z,type:u.Tv.File,initialValue:p,rename:!0}):(0,a.tZ)(s.G7,{tag:"button",onDoubleClick:w,css:[h],onClick:i,children:(0,a.tZ)(s.xv,{children:p})}),(0,a.tZ)(b,{onClick:o})]}))}})}function x(e){var n=e.title,i=e.onClick,t=e.onClose,r=e.isActive,o=e.innerRef;return(0,a.BX)(s.Tg,{elevated:r,innerRef:o,css:[v.base,r?v.active:v.inactive,s.l0.flex.row,s.l0.align.center,s.l0.pr(4)],children:[(0,a.tZ)(s.G7,{tag:"button",css:[h],onClick:i,children:(0,a.tZ)(s.xv,{children:n})}),(0,a.tZ)(b,{onClick:t})]})}},99904:function(e,n,i){i.d(n,{Z:function(){return l}});var t=i(67294),r=i(2426),a=i(23837),o={overflowBehavior:{y:"hidden"},scrollbars:{autoHide:"leave"}};function l(){var e,n=(0,t.useRef)(null),i=null===(e=n.current)||void 0===e?void 0:e.osInstance(),l=(0,t.useRef)(0),s=(0,t.useRef)(0),d=(0,a.Z)();return{options:o,handleWheel:function(e){if(i&&0!==e.deltaY&&0===e.deltaX){var n=e.deltaY<0?-1:1,t=s.current!==n?i.scroll().position.x:l.current,r=25*n,a=i.scroll().max.x;l.current=Math.max(0,Math.min(a,t-r)),s.current=n;var o=function(){if(i){var e=i.scroll().position.x,n=l.current-e,t=Math.round(e+n/10);0!==n&&(i.scroll({x:t}),window.requestAnimationFrame(o))}};window.requestAnimationFrame(o)}},ref:n,className:d===r.V2.replitLight?"os-theme-dark":"os-theme-light"}}},56679:function(e,n,i){i.d(n,{Z:function(){return T}});var t=i(14924),r=i(10253),a=i(35944),o=i(35642),l=i(67294),s=i(61756),d=i(34193),c=i(1879),u=i(90317),m=i(26082),p=i(93058),f=i(1144),v=i(69346),h=i(99408),b=i(81255),g=i(88075);function Z(e){var n,i=e.replId,t=e.onDone,o=e.isResubmit,l=e.lastUpdated,d=e.openIOtesterPane,c=(0,h.Z)().iotester,m=(0,u.CHr)({variables:{replId:i}}),Z=c.lastRunAt.getTime()>l,x=(0,u.xhi)({variables:{replId:i}}).data,y="Repl"===(null===x||void 0===x?void 0:x.repl.__typename)?x.repl:null,w=(null===y||void 0===y?void 0:y.template)||null,k=(null===w||void 0===w?void 0:w.dueDate)||null,j=(new Date).toISOString(),_=(0,p.Z)(),C=_.showConfirm,I=_.showError,E=(0,r.Z)((0,u.xAQ)({variables:{replId:i},onCompleted:function(e){var n=e.submitRepl;"UserError"!==n.__typename?"Repl"===n.__typename&&(C("Repl submitted"),t()):I(n.message)},onError:function(e){I(e.message)}}),2),R=E[0],S=E[1],T=Z&&c.lastRunDidPass;return"Repl"===(null===(n=m.data)||void 0===n?void 0:n.repl.__typename)&&m.data.repl.ioTests.length>0&&!T?(0,a.BX)(v.Z,{css:[b.l0.colWithGap(24)],children:[(0,a.tZ)(f.h,{variant:"headerDefault",level:2,children:Z?"Fix test failures before submitting":"Run tests before submitting"}),(0,a.tZ)(f.x,{multiline:!0,children:Z?"Input/Output tests did not pass.":"Input/Output tests have not been run since this Repl was last changed."}),(0,a.BX)(v.Z,{css:[b.l0.rowWithGap(12),b.l0.justify.end],children:[(0,a.tZ)(s.ZP,{disabled:S.loading,colorway:"primary",onClick:function(){d(),t()},text:"View tests"}),(0,a.tZ)(s.ZP,{disabled:S.loading,onClick:function(){return R()},iconLeft:(0,a.tZ)(g.Z,{}),text:"Submit anyway"})]})]}):(0,a.BX)(v.Z,{css:[b.l0.colWithGap(24)],children:[(0,a.tZ)(f.h,{variant:"headerDefault",level:2,children:o?" Resubmit Repl":"Submit Repl"}),(0,a.tZ)(f.x,{multiline:!0,children:o?"This will re-notify Team admins about your submission.":"This will submit your Repl for review and notify the Team's admins."}),k&&k<j&&(0,a.tZ)(f.x,{multiline:!0,css:[b.l0.color.accentNegativeStronger],children:"Note: Your submission is past the due date and will be marked late."}),(0,a.BX)(v.Z,{css:[b.l0.rowWithGap(12),b.l0.justify.end],children:[(0,a.tZ)(s.ZP,{disabled:S.loading,onClick:t,text:"Cancel"}),(0,a.tZ)(s.ZP,{colorway:"primary",disabled:S.loading,onClick:function(){return R()},iconLeft:(0,a.tZ)(g.Z,{}),text:o?"Submit again":"Submit"})]})]})}var x,y=i(97813),w=i(65456),k=i(48551),j=i(37424),_=i(77365),C=i(28479),I=i(34847),E=i(60731),R=function(e){var n,i,t,o,s,d,c,m,f,v=e.replId,h=e.onDone,b=(0,p.Z)(),Z=b.showConfirm,x=b.showError,y=(0,u.fuF)({variables:{replId:v},onCompleted:function(e){var n,i,t=e.repl;"Repl"===t.__typename&&(null===(n=t.origin)||void 0===n||null===(i=n.template)||void 0===i?void 0:i.modelSolution)&&"ReplTemplateModelSolution"===t.origin.template.modelSolution.__typename&&(B(t.origin.template.modelSolution.visibleAfterSubmitting),P(t.origin.template.modelSolution.visibleAfterPassingTests),A(t.origin.template.modelSolution.visibleAfterDueDate))}}),w=y.data,k=y.loading,R=(0,r.Z)((0,u.GA6)({onError:function(e){return x(e)},onCompleted:function(){Z("Updated solution"),h()}}),2),S=R[0],T=R[1],U=(0,r.Z)(l.useState(!1),2),N=U[0],B=U[1],M=(0,r.Z)(l.useState(!1),2),D=M[0],P=M[1],X=(0,r.Z)(l.useState(!1),2),O=X[0],A=X[1],z=(0,r.Z)(l.useState(),2),G=z[0],F=z[1],V=(0,j.H)();if(l.useEffect((function(){var e="Students can ";if(N||O||D){e+="view the solution after";var n=[];N&&n.push("submitting their project"),D&&n.push("passing all tests"),O&&n.push("the due date has passed");for(var i=0;i<n.length;i++)i>0&&(e+=",",i===n.length-1&&(e+=" and")),e+=" "+n[i];e+="."}else e+="never view the solution.";F(e)}),[N,D,O]),k)return(0,a.tZ)(E.G7,{css:[E.l0.center],children:(0,a.tZ)(_.Z,{})});var L="Repl"===(null===w||void 0===w?void 0:w.repl.__typename)&&"Team"===(null===(n=w.repl.owner)||void 0===n?void 0:n.__typename)&&(null===(i=w.repl.owner)||void 0===i?void 0:i.id),W="Repl"===(null===w||void 0===w?void 0:w.repl.__typename)&&(null===(t=w.repl.origin)||void 0===t||null===(o=t.template)||void 0===o?void 0:o.modelSolution);if(!W)return null;var q=W.id,H="Repl"===(null===w||void 0===w?void 0:w.repl.__typename)&&((null===(s=w.repl.origin)||void 0===s?void 0:s.ioTests.length)||(null===(d=w.repl.origin)||void 0===d||null===(c=d.unitTests)||void 0===c?void 0:c.tests.length)),Y="Repl"===(null===w||void 0===w?void 0:w.repl.__typename)&&(null===(m=w.repl.origin)||void 0===m||null===(f=m.template)||void 0===f?void 0:f.dueDate);return(0,a.tZ)("form",{onSubmit:function(e){e.preventDefault(),L&&q&&S({variables:{input:{teamId:L,solutionId:q,visibleAfterSubmitting:N,visibleAfterPassingTests:D,visibleAfterDueDate:O}}})},children:(0,a.BX)(E.G7,{css:[E.l0.colWithGap(24)],children:[(0,a.tZ)(E.h4,{level:1,variant:"headerDefault",children:"Update solution"}),(0,a.BX)(E.G7,{css:[E.l0.colWithGap(16)],children:[(0,a.BX)(E.G7,{css:[E.l0.rowWithGap(8)],children:[(0,a.tZ)(E.XZ,{id:V("availableAfterSubmitting"),checked:N,onChange:function(){return B(!N)}}),(0,a.tZ)("label",{htmlFor:V("availableAfterSubmitting"),children:(0,a.tZ)(E.xv,{children:"Available after submitting"})})]}),(0,a.BX)(E.G7,{css:[E.l0.rowWithGap(8)],children:[(0,a.tZ)(E.XZ,{id:V("availableAfterPassingTests"),checked:D,onChange:function(){return P(!D)}}),(0,a.tZ)("label",{htmlFor:V("availableAfterPassingTests"),children:(0,a.BX)(E.G7,{css:[E.l0.rowWithGap(4)],children:[(0,a.tZ)(E.xv,{children:"Available after passing tests"}),(0,a.BX)(E.xv,{children:["(",H?"".concat(H," ").concat((0,I.Z)("test",H)," defined"):"no tests exist yet",")"]})]})})]}),(0,a.BX)(E.G7,{css:[E.l0.rowWithGap(8),{verticalAlign:"baseline"}],children:[(0,a.tZ)(E.XZ,{id:V("availableAfterDueDate"),checked:O,onChange:function(){return A(!O)}}),(0,a.tZ)("label",{htmlFor:V("availableAfterDueDate"),children:(0,a.BX)(E.G7,{css:[E.l0.rowWithGap(4)],children:[(0,a.tZ)(E.xv,{children:"Available after due date"}),(0,a.BX)(E.xv,{css:{textDecoration:"italic"},children:["(",Y?(0,C.p)(Y):"no due date set yet",")"]})]})})]})]}),(0,a.tZ)(E.E_,{text:"".concat(G),colorway:N||D||O?"positive":"negative"}),(0,a.tZ)(E.G7,{css:{alignItems:"end"},children:(0,a.tZ)(E.zx,{stretch:!1,colorway:"primary",text:"".concat(T.loading?"Saving...":"Save"),iconLeft:(0,a.tZ)(g.Z,{}),disabled:T.loading})})]})})},S=(x={},(0,t.Z)(x,u.Sy.PublishTemplate,"Publish project"),(0,t.Z)(x,u.Sy.EditTemplate,"Edit project"),(0,t.Z)(x,u.Sy.Submit,"Submit"),(0,t.Z)(x,u.Sy.Resubmit,"Resubmit"),(0,t.Z)(x,u.Sy.UpdateModelSolution,"Update solution"),x);function T(e){var n=e.cta,i=e.replId,t=e.isGroupProject,p=e.openIOtesterPane,f=(0,r.Z)(l.useState(null),2),v=f[0],b=f[1],x=function(){return b(null)},j=(0,y.Z)(),_=(0,h.Z)().fs,C=(0,r.Z)(l.useState(0),2),I=C[0],E=C[1];l.useEffect((function(){if(j&&!(0,k.T3)(j)&&!(0,k.sL)(j)){var e=_.watchOtFile(j,{onChange:function(e){e.changeSource===w.Fl.Local&&E(Date.now())}});return e}}),[j,_,E]);var T=Boolean(v&&[u.Sy.PublishTemplate,u.Sy.EditTemplate].includes(v));return l.useEffect((function(){n===u.Sy.ReviewSubmission&&(o.Z.get("annotations/educationModalDismissed")||(b(n),o.Z.set("annotations/educationModalDismissed",!0)))}),[n]),(0,a.BX)(a.HY,{children:[S[n]&&(0,a.tZ)(s.ZP,{onClick:function(){return b(n)},text:S[n],iconLeft:(0,a.tZ)(g.Z,{})}),(0,a.tZ)(c.Z,{isOpen:v===u.Sy.Submit||v===u.Sy.Resubmit,onRequestClose:x,maxWidth:512,children:(0,a.tZ)(Z,{replId:i,onDone:x,isResubmit:v===u.Sy.Resubmit,lastUpdated:I,openIOtesterPane:p})}),(0,a.tZ)(d.Z,{preventClose:!0,isOpen:T,onRequestClose:x,width:t?"large":"medium",children:(0,a.tZ)(m.Z,{replId:i,onDone:x})}),(0,a.tZ)(c.Z,{isOpen:v===u.Sy.UpdateModelSolution,onRequestClose:x,maxWidth:600,children:(0,a.tZ)(R,{replId:i,onDone:x})})]})}},1129:function(e,n,i){i.d(n,{Z:function(){return I}});var t=i(10253),r=i(35944),a=i(60536),o=i.n(a),l=i(67294),s=i(90317),d=i(57263),c=i(13122),u=i(26042),m=i(69396),p=i(94184),f=i.n(p),v=i(77365),h=i(63377),b=i(58502),g=i(99408),Z=i(44746),x=i(60731);function y(e){var n=e.hideModal,i=e.onUserClick,t=e.isOpen,a=(0,h.Z)(),o=(0,g.Z)().presence,l=(0,b.Z)({presence:o});return(0,r.tZ)(x.u_,{isOpen:t,onRequestClose:n,children:(0,r.tZ)(k,{replId:a,onUserClick:i,activeUsers:l,hideModal:n})})}function w(e,n){return n.some((function(n){return n.id===e}))}function k(e){var n=e.replId,i=e.activeUsers,t=e.onUserClick,a=e.hideModal,o=(0,s.Flq)({variables:{replId:n}}),l=o.data,d=o.loading,c=o.error;if(d)return(0,r.tZ)(x.G7,{css:[x.l0.flex.row,x.l0.justify.center,x.l0.p(32)],children:(0,r.tZ)(v.Z,{})});if(c)return(0,r.tZ)("div",{children:c.message});if("Repl"===(null===l||void 0===l?void 0:l.repl.__typename)){var p=l.repl,f=l.currentUser,h=p.user,b=h&&i.find((function(e){return e.username===h.username})),g=p.permissions.filter((function(e){var n=e.user;return n&&w(n.id,i)})),Z=p.permissions.filter((function(e){var n=e.user;return n&&!w(n.id,i)}));return(0,r.BX)(x.G7,{css:[x.l0.colWithGap(24)],children:[(0,r.tZ)(x.h4,{level:1,variant:"headerDefault",children:"Multiplayers"}),(0,r.tZ)(x.xv,{multiline:!0,children:"Users can interact with this Repl in real time."}),(0,r.tZ)(x.G7,{css:[x.l0.maxHeight(330),{overflowY:"auto"}],children:(0,r.BX)(x.G7,{children:[h?(0,r.tZ)(_,(0,m.Z)((0,u.Z)({},h),{onClick:t,isOnline:Boolean(b),color:b?b.color:"transparent",isOwner:!0,hideModal:a,canClickAvatar:Boolean(b)&&h.id!==(null===f||void 0===f?void 0:f.id),type:s.aQH.Rw})):null,g.map((function(e){var n=e.type,o=e.user;if(!o)throw new Error("Expected user");var l=i.find((function(e){return e.username===o.username}));if(!l)throw new Error("Expected user online");var s=o.id!==(null===f||void 0===f?void 0:f.id);return(0,r.tZ)(_,(0,m.Z)((0,u.Z)({onClick:t,type:n},o),{isOnline:!0,canClickAvatar:s,color:l.color,hideModal:a,isOwner:!1}),"chat-user-list-".concat(o.username))})),Z.map((function(e){var n=e.type,i=e.user;if(!i)throw new Error("Expected user");return(0,r.tZ)(_,(0,m.Z)((0,u.Z)({onClick:t,type:n},i),{canClickAvatar:!1,isOnline:!1,color:"transparent",hideModal:a,isOwner:!1}),"chat-user-list-".concat(i.username))}))]})})]})}return"ReplRedirect"===(null===l||void 0===l?void 0:l.repl.__typename)?(0,r.BX)("div",{children:["This Repl has moved to"," ",(0,r.tZ)("a",{href:l.repl.replUrl,children:l.repl.replUrl})]}):"SubscriptionExpiredError"===(null===l||void 0===l?void 0:l.repl.__typename)?(0,r.BX)("div",{children:["Your subscription has expired.",(0,r.tZ)("a",{href:"/pricing",children:"Upgrade here"})]}):null}var j={r:"read only",rw:"can edit"};function _(e){var n=e.type,i=e.id,t=e.username,a=e.image,l=e.isOnline,s=e.isOwner,d=e.color,c=e.onClick,u=e.hideModal,m=e.canClickAvatar,p=(0,Z.Z)();return(0,r.BX)("div",{className:o().dynamic([["8abf4fce485dcead",[m?"pointer":"auto",d]]])+" "+(f()("user-list-item-wrapper",{online:l})||""),children:[(0,r.tZ)("div",{onClick:function(){m&&(p({username:t,id:i}),u())},className:o().dynamic([["8abf4fce485dcead",[m?"pointer":"auto",d]]])+" image",children:(0,r.tZ)("img",{src:a,className:o().dynamic([["8abf4fce485dcead",[m?"pointer":"auto",d]]])+" "+((l?"":"offline")||"")})}),(0,r.BX)("div",{className:o().dynamic([["8abf4fce485dcead",[m?"pointer":"auto",d]]])+" info",children:[(0,r.BX)("div",{className:o().dynamic([["8abf4fce485dcead",[m?"pointer":"auto",d]]]),children:[(0,r.BX)("a",{href:"/@".concat(t),target:"_blank",onClick:c,className:o().dynamic([["8abf4fce485dcead",[m?"pointer":"auto",d]]]),children:["@",t]}),!l&&" (offline)"]}),(0,r.tZ)("div",{className:o().dynamic([["8abf4fce485dcead",[m?"pointer":"auto",d]]]),children:s?"owner":j[n]})]}),(0,r.tZ)(o(),{id:"8abf4fce485dcead",dynamic:[m?"pointer":"auto",d],children:".user-list-item-wrapper.__jsx-style-dynamic-selector{padding:var(--space-8);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-ordinal-group:2;-webkit-order:1;-moz-box-ordinal-group:2;-ms-flex-order:1;order:1}.image.__jsx-style-dynamic-selector{-webkit-box-flex:0;-webkit-flex:0 0 auto;-moz-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;cursor:".concat(m?"pointer":"auto","}img.__jsx-style-dynamic-selector{width:40px;height:40px;-webkit-border-radius:20px;-moz-border-radius:20px;border-radius:20px;border:3px solid ").concat(d,";background:white;-o-object-fit:cover;object-fit:cover}.info.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-left:var(--space-8)}img.offline.__jsx-style-dynamic-selector{-webkit-filter:grayscale(100%);filter:grayscale(100%)}.user-list-item-wrapper.online.__jsx-style-dynamic-selector{-webkit-box-ordinal-group:1;-webkit-order:0;-moz-box-ordinal-group:1;-ms-flex-order:0;order:0}")})]})}var C=i(86292);function I(e){var n=(0,t.Z)(l.useState(!1),2),i=n[0],a=n[1],u=(0,h.Z)(),m=(0,s.qC4)({variables:{ids:e.users.map((function(e){return e.id}))},ssr:!1,skip:!e.users.length}),p=m.data,f=m.loading,v=m.error,b=e.users.reduce((function(e,n){return e[n.id]=n.color,e}),{});if(f)return null;if(v)return null;if(!(null===p||void 0===p?void 0:p.currentUser))return null;var g=p.usersByIds,Z=p.currentUser,w=g.filter((function(e){return e.id!==Z.id})),k=w.length-3;return(0,r.BX)(x.G7,{tag:"ul",className:"multiplayer-users-container",css:[x.l0.px(8),x.l0.rowWithGap(4),x.l0.align.center],"aria-live":"polite","aria-relevant":"additions removals","aria-label":"online users",children:[k>0?(0,r.tZ)("li",{className:o().dynamic([["9e6f75ce31331994",[d.j.mobileMax+100]]]),children:(0,r.tZ)(x.zx,{onClick:function(){return a(!0)},text:"+ ".concat(k),css:{background:"none"}})}):null,w.slice(0,3).map((function(n){return(0,r.tZ)("li",{className:o().dynamic([["9e6f75ce31331994",[d.j.mobileMax+100]]]),children:(0,r.tZ)(c.Z,{id:n.id,username:n.username,image:n.image,color:b[n.id],onClick:e.onAvatarClick,canClick:!0})},n.id)})),(0,r.tZ)(y,{isOpen:i,hideModal:function(){return a(!1)},onUserClick:function(){(0,C.j)(C.U3.MP2_VISITED_PROFILE,{replId:u,from:"OnlineUsers"})}}),(0,r.tZ)(o(),{id:"9e6f75ce31331994",dynamic:[d.j.mobileMax+100],children:".multiplayer-users-container.__jsx-style-dynamic-selector li.__jsx-style-dynamic-selector{list-style-type:none}@media only screen and (max-width:".concat(d.j.mobileMax+100,"px){.multiplayer-users-container.__jsx-style-dynamic-selector{display:none}}")})]})}}}]);
//# sourceMappingURL=1092-f5ebf70f29503f0b.js.map